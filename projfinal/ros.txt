sudo apt update && sudo apt upgrade -y
sudo apt install -y software-properties-common
sudo add-apt-repository universe -y

# RepositÃ³rio do ROS 2 (usa ros2-apt-source, recomendaÃ§Ã£o oficial)
sudo apt update
sudo apt install -y curl gnupg lsb-release
sudo curl -sSL https://raw.githubusercontent.com/ros/rosdistro/master/ros.key -o /usr/share/keyrings/ros-archive-keyring.gpg
echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/ros-archive-keyring.gpg] http://packages.ros.org/ros2/ubuntu $(. /etc/os-release && echo $UBUNTU_CODENAME) main" | sudo tee /etc/apt/sources.list.d/ros2.list > /dev/null

sudo apt update
sudo apt install -y ros-humble-desktop
echo "source /opt/ros/humble/setup.bash" >> ~/.bashrc
source ~/.bashrc




proximo passo

sudo apt update
sudo apt install -y curl gnupg lsb-release
sudo curl -sSL https://raw.githubusercontent.com/ros/rosdistro/master/ros.key -o /usr/share/keyrings/ros-archive-keyring.gpg
echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/ros-archive-keyring.gpg] http://packages.ros.org/ros2/ubuntu $(. /etc/os-release && echo $UBUNTU_CODENAME) main" | sudo tee /etc/apt/sources.list.d/ros2.list > /dev/null

sudo apt update
sudo apt install -y ros-humble-desktop
echo "source /opt/ros/humble/setup.bash" >> ~/.bashrc
source ~/.bashrc


proximo passo
sudo apt update
sudo apt install -y build-essential git python3-colcon-common-extensions



1) Criar o workspace e preparar ambiente
# Workspace
mkdir -p ~/ros2_ws/src
cd ~/ros2_ws
colcon build --symlink-install
echo "source ~/ros2_ws/install/setup.bash" >> ~/.bashrc
source ~/.bashrc


2) Driver do RPLIDAR (ROS 2) â€” sllidar_ros2
cd ~/ros2_ws/src
git clone https://github.com/Slamtec/sllidar_ros2.git
cd ~/ros2_ws
colcon build --symlink-install
# PermissÃ£o para portas seriais
sudo usermod -aG dialout $USER
# (faÃ§a logout/login ou reboot para aplicar o grupo 'dialout')


Conecte o RPLIDAR; normalmente ele aparece como /dev/ttyUSB0:

ls -l /dev/ttyUSB* /dev/ttyACM* 2>/dev/null


***********************
1) Confirma os 3 processos, 
06051982AQUI ABRIR PARA CRIAR O MAPA, deu certo atenÃ§Ã£o veja o item dois com atenÃ§Ã£o.

Terminal 1 (LIDAR C1): (deixa rodando)

ros2 launch sllidar_ros2 sllidar_c1_launch.py \
  serial_port:=/dev/ttyUSB0 channel_type:=serial serial_baudrate:=460800 frame_id:=laser


Terminal 2 (TF estÃ¡tica): (deixa rodando)

ros2 run tf2_ros static_transform_publisher 0 0 0 0 0 0 base_link laser


Terminal 3 (SLAM sem odometria): (deixa rodando)

ros2 run slam_toolbox async_slam_toolbox_node --ros-args \
  -p odom_frame:=base_link \
  -p base_frame:=base_link \
  -p map_frame:=map \
  -p scan_topic:=/scan

2) Mostra no RViz (o que estÃ¡ faltando aÃ­)

source /opt/ros/humble/setup.bash
LIBGL_ALWAYS_SOFTWARE=1 rviz2

No painel esquerdo: Global Options â†’ Fixed Frame = base_link (ou laser).

Clica Add â†’ By topic â†’ /scan â†’ LaserScan (vai aparecer o cÃ­rculo/pontos do LIDAR).

ComeÃ§a a mover o sensor/robÃ´ (girar/andar).

Quando o mapa comeÃ§ar a sair, troca o Fixed Frame para map.

Clica Add â†’ Map e escolhe o tÃ³pico /map.



***************************************

âœ… Terminal 1 â€” LIDAR
source /opt/ros/humble/setup.bash
source ~/ros2_ws/install/setup.bash

ros2 launch sllidar_ros2 sllidar_c1_launch.py \
  serial_port:=/dev/ttyUSB0 \
  channel_type:=serial \
  serial_baudrate:=460800 \
  frame_id:=laser

âœ… Terminal 2 â€” TF (ligaÃ§Ã£o base_link â†’ laser)

(se nÃ£o rodar isso, o mapa nÃ£o aparece!)

source /opt/ros/humble/setup.bash

ros2 run tf2_ros static_transform_publisher 0 0 0 0 0 0 base_link laser

âœ… Terminal 3 â€” SLAM Toolbox
source /opt/ros/humble/setup.bash

ros2 run slam_toolbox async_slam_toolbox_node --ros-args \
  -p scan_topic:=/scan \
  -p base_frame:=base_link \
  -p odom_frame:=base_link \
  -p map_frame:=map

âœ… Abrir o RViz

no ambiente grÃ¡fico (WTS), abra um terminal e execute:

source /opt/ros/humble/setup.bash
LIBGL_ALWAYS_SOFTWARE=1 rviz2


Dentro do RViz:

Global Options â†’ Fixed Frame = base_link

Add â†’ LaserScan â†’ /scan

Depois que o SLAM comeÃ§ar a gerar /map:

Mude: Fixed Frame = map

Adicione: Add â†’ Map â†’ /map

ðŸ’¾ Para salvar o mapa (quando estiver bom):

Num novo terminal:

source /opt/ros/humble/setup.bash

ros2 run nav2_map_server map_saver_cli \
  -f ~/meu_mapa \
  --ros-args -p map_topic:=/map -p map_subscribe_transient_local:=true


O arquivo serÃ¡ salvo como:

~/meu_mapa.pgm
~/meu_mapa.yaml




###################### NOVO TESTE 2026