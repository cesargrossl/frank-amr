Terminal 1 (LIDAR C1): (deixa rodando)

ros2 launch sllidar_ros2 sllidar_c1_launch.py \
  serial_port:=/dev/ttyUSB0 channel_type:=serial serial_baudrate:=460800 frame_id:=laser


Terminal 2 (TF estÃ¡tica): (deixa rodando)

ros2 run tf2_ros static_transform_publisher 0 0 0 0 0 0 base_link laser


Terminal 3 (SLAM sem odometria): (deixa rodando)

ros2 run slam_toolbox async_slam_toolbox_node --ros-args \
  -p odom_frame:=base_link \
  -p base_frame:=base_link \
  -p map_frame:=map \
  -p scan_topic:=/scan

2) Mostra no RViz (o que estÃ¡ faltando aÃ­)

source /opt/ros/humble/setup.bash
LIBGL_ALWAYS_SOFTWARE=1 rviz2

source /opt/ros/humble/setup.bash
LIBGL_ALWAYS_SOFTWARE=1 rviz2


No painel esquerdo: Global Options â†’ Fixed Frame = base_link (ou laser).

Clica Add â†’ By topic â†’ /scan â†’ LaserScan (vai aparecer o cÃ­rculo/pontos do LIDAR).
âœ… FASE 1 â€” Ajustar o RViz para visualizar o SLAM

ğŸ‘‰ Global Options â†’ Fixed Frame â†’ map


No canto inferior esquerdo:

Add â†’ Map

Type: Map

Topic: /map

Isso vai mostrar o mapa que o slam_toolbox estÃ¡ criando.


Add â†’ TF

Mostra as setas dos frames (map, base_link, laser).

Ajuda a confirmar se o SLAM estÃ¡ publicando map â†’ base_link.
âœ… FASE 2 â€” Criar o mapa andando pelo ambiente

Agora vocÃª precisa mover o robÃ´ pelo ambiente:

Devagar

Fazendo curvas

Dando uma volta completa no local

Passando perto das paredes

Enquanto isso, vocÃª vai ver:

âœ”ï¸ O mapa ficando mais denso
âœ”ï¸ Paredes aparecendo
âœ”ï¸ O robÃ´ se posicionando corretamente no map

Quando estiver satisfeito com o mapa â†’ vamos salvar.

ros2 run nav2_map_server map_saver_cli -t /map -f /home/ubuntu/meu_mapa


âœ… FASE 3 â€” Salvar o mapa

Abra um Terminal 4:


Abaixo deu certo
ros2 run nav2_map_server map_saver_cli -t /map -f /home/ubuntu/mapa_logistica

Verifico se rodou
ls /home/ubuntu | grep mapa_logistica

Isso cria dois arquivos no seu home:

meu_mapa.yaml

meu_mapa.pgm

Esses sÃ£o o seu mapa definitivo.

ğŸŒ FASE 4 â€” Usar o mapa salvo (Modo LocalizaÃ§Ã£o)

Agora vocÃª nÃ£o precisa mais refazer o SLAM.
Vamos rodar o slam_toolbox apenas para localizar.

Feche o SLAM que estava rodando.
Depois abra um novo terminal:

ros2 run slam_toolbox async_slam_toolbox_node --ros-args \
  -p mode:=localization \
  -p map_file_name:=/home/ubuntu/mapa_logistica.yaml \
  -p odom_frame:=base_link \
  -p base_frame:=base_link \
  -p map_frame:=map \
  -p scan_topic:=/scan

4.1. Abra novamente o RViz

E configure assim:

Fixed Frame = map

Adicione:

Map

LaserScan

TF

Agora, quando vocÃª mexer o robÃ´:

âœ”ï¸ Ele se localiza dentro do mapa
âœ”ï¸ O /map fica fixo
âœ”ï¸ Apenas a pose (base_link) se mexe

Isso significa que vocÃª estÃ¡ pronto para:

NavegaÃ§Ã£o

Nav2

Planejamento de trajetÃ³ria

ğŸ§­ FASE 5 â€” PrÃ³ximos passos (se quiser evoluir)

Aqui Ã© onde vocÃª pode levar o AMR para o â€œnÃ­vel profissionalâ€:

âœ”ï¸ 1. Adicionar odometria de rodas

Melhora muito o SLAM

Ajuda nos loops (fechamento de mapa)

âœ”ï¸ 2. Criar um URDF

Para o RViz mostrar o robÃ´ em 3D

Para o Nav2 calcular footprint corretamente

âœ”ï¸ 3. Habilitar o Nav2

Com isso, vocÃª vai:

Clicar no mapa â†’ cara ir sozinho atÃ© lÃ¡

Ter path planning

Ter controle de velocidade automÃ¡tico

Ter desvio de obstÃ¡culos

ğŸ¯ RESUMO FINAL

VocÃª estÃ¡ nesse ponto:

LIDAR funcionando âœ”
TF funcionando âœ”
SLAM rodando âœ”
RViz com scan âœ”


Agora siga isso:

[1] No RViz â†’ Fixed Frame = map
[2] Add â†’ Map (/map)
[3] Mexer o robÃ´ â†’ mapa nasce
[4] Salvar mapa â†’ map_saver_cli
[5] Rodar modo localization â†’ usar o mapa sem recriar


Se quiser, posso montar um tutorial em PDF, ou um fluxograma visual, ou atÃ© deixar tudo pronto em um Ãºnico launch file para vocÃª rodar tudo com um comando.

Como prefere seguir?


Agora vamos ver o resultado proximo passo LocalizaÃ§Ã£o
